<!DOCTYPE html>
<html>

<head>
  <!--Import Google Icon Font-->
  <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!--Import materialize.css-->
  <link type="text/css" rel="stylesheet" href="materialize/css/materialize.min.mod.css"  media="screen,projection"/>
  <!--Import event expand view css-->
  <link type="text/css" rel="stylesheet" href="materialize/css/expandview.css"/>

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <meta charset="UTF-8">
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script defer src="http://maps.google.com/maps/api/js?key=AIzaSyB6Lz24NEsy8I_cDxm6vUVGXlqwNlkC2yk&language=en"></script>
  <script src="jqueryGoogleMapAPI/jquery.googlemap.js"></script>
</head>

<body style="height:800px">
  <script type="text/javascript" src="materialize/js/materialize.min.js"></script>

  <script>
    //document.ready
    $(function(){
      //Script that allows modals to work
      // the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
      $('.modal-trigger').leanModal();

      //Script that allows date to work
      $('.datepicker').pickadate({
        selectMonths: true, // Creates a dropdown to control month
        selectYears: 16 // Creates a dropdown of 15 years to control year
      });

      //Script that send search data to server
      $('#search').click(function(){
        var newStartDateString, newEndDateString;
        if ($('#startDate').val() == ""){
          var fullDate = new Date()
          //convert month to 2 digits
          var twoDigitMonth = ((fullDate.getMonth().length+1) === 1)? (fullDate.getMonth()+1) : '0' + (fullDate.getMonth()+1);
          newStartDateString = fullDate.getFullYear() + "/" + twoDigitMonth + "/" + fullDate.getDate();
        } else {
          newStartDateString = "Y/M/D";
          var startDateString = $('#startDate').val().split(/[,]? /);
          var newMonth =  "JanFebMarAprMayJunJulAugSepOctNovDec".indexOf(startDateString[1].substring(0,3))/3+1;
          newStartDateString = newStartDateString
            .replace("D", startDateString[0]<10 ? "0"+startDateString[0] : startDateString[0])
            .replace("M", newMonth<10 ? "0"+newMonth : newMonth)
            .replace("Y", startDateString[2]);
        }
        if ($('#endDate').val() == "") {
          newEndDateString = "nnull";
        } else {
          newEndDateString = "Y/M/D";
          var endDateString = $('#endDate').val().split(/[,]? /);
          var newMonth =  "JanFebMarAprMayJunJulAugSepOctNovDec".indexOf(endDateString[1].substring(0,3))/3+1;
          newEndDateString = newEndDateString
            .replace("D", endDateString[0]<10 ? "0"+endDateString[0] : endDateString[0])
            .replace("M", newMonth<10 ? "0"+newMonth : newMonth)
            .replace("Y", endDateString[2]);
        }
        console.log(newStartDateString);
        console.log(newEndDateString);

        var majorString = $('#major').val()==null ? 'nnull' : $('#major').val();
        var categoryString = $('#category').val()=="" ? 'nnull' : $('#category').val();
        console.log(majorString);
        console.log(categoryString);

        $.ajax({
          type: "POST",
          url: "getPostingListByFilter.php",
          data: {
            major: majorString,
            category: categoryString,
            startDate: newStartDateString,
            endDate: newEndDateString
          },
          success: function(result, status, xhr) {
            //TO BE IMPLEMENTED
            console.log("Data: " + data) + "\nStatus: " + status;
          },
          error: function(xhr, status, error) {
            alert("An error occured: " + xhr.status + " " + xhr.statusText);
          }
        });
      });
      //Script that allows select to work
      $('select').material_select();

      //googleMapAPI
      $('#mapholder')
        .googleMap({
          coords: [36.9923454, -122.0613478],
          zoom: 15,
          type: "ROADMAP",
          scrollwheel: true
        });
    });
  </script>

  
  <nav>
    <div class="nav-wrapper" style="background-color:#71ABA7;">
      <a href="#" class="brand-logo left"><img src="../images/png/logo.png" height="20px" width="80px" style="margin-left:20px;"></img></a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li style="margin-right:1rem;">
          <select id="major">
            <option value="" disabled selected>Major</option>
            <option value="Art">Art</option>
            <option value="Biology">Biology</option>
            <option value="Computer Science">Computer Science</option>
            <option value="Economics">Economics</option>
            <option value="History">History</option>
            <option value="Mathematics">Mathematics</option>
            <option value="Physics">Physics</option>
          </select>
        </li>
        <li style="margin-right:1rem">
          <select id="category" multiple>
            <option value="" disabled selected>Category</option>
            <option value="Sport">Sport</option>
            <option value="Game">Game</option>
            <option value="Party">Party</option>
            <option value="Study">Study</option>
            <option value="etc">etc</option>
          </select>
        </li>
        <li style="margin-right:1rem">
          <input id="startDate" placeholder="start date" type="date" class="datepicker"></input>
        </li>
        <li>
          <input id="endDate" placeholder="end date" type="date" class="datepicker"></input>
        </li>
        <li style="margin-right:2rem;">
          <a id="search" style="height:40px; width:50px;"><img src="../images/png/search.png" height="20px" width="20px" style="margin-top:10px"></img></a>
        </li>
        <li>
          <a href="#!" style="height:40px; width:50px;">
            <img src="../images/png/notification.png" height="25px" width="20px" style="margin-top:7px;" />
          </a>
        </li>
        <li>
          <ul id="dropdown1" class="dropdown-content">
            <li><a href="#!">one<span class="badge">3</span></a></li>
            <li><a href="#!">two</a></li>
            <li class="divider"></li>
            <li><a href="#!">Logout</a></li>
          </ul>
          <a href="#!" class="dropdown-button" style="height:40px; width:50px; margin-right:10px;" data-activates="dropdown1">
            <img src="../images/png/gear.png" height="25px" width="25px" style="margin-top:7px;" />
          </a>
        </li>
      </ul>
    </div>
  </nav>
  <main class="row" style="height:87%;">
    <!-- Events -->
    <aside class="col s12 m12 l3" style="height:100%; margin-top:0.5%;">
      <ul class="collapsible" style="overflow:scroll; height:100%; width:100%;">
        <!-- Events will be located in here. You can remove all the "test" sample in here(and this comment).  -->
          <li class="scrollspy" id="evt5">
          <a href="#evt5" class="collapsible-header">test</a>
          <span class="collapsible-body">test</span>
        </li>
       <li class="scrollspy" id="evt4">
          <a href="#evt4" class="collapsible-header">test</a>
          <span class="collapsible-body">test</span>
        </li>
       <li class="scrollspy" id="evt3">
          <a href="#evt3" class="collapsible-header">test</a>
          <span class="collapsible-body">test</span>
        </li>

        <li class="scrollspy" id="evt2">
          
          <a href="#evt2" class="collapsible-header">
            <div class="evtName">Event Name</div>
            <div class="evtRating">3.5</div>
            <div class="evtCreator">event creator name</div>
          </a>
          
          <span class="collapsible-body">
            <!-- Event buttons -->
            <div class="evtBtns">
              <a href="#!" class="evtBtnEnter">
                <img src="../images/png/search.png" height="25px" width="20px" style="margin-top:7px;"/>
                Enter</a>
              <a href="#!" class="evtBtnMessage">
                <img src="../images/png/search.png" height="25px" width="20px" style="margin-top:7px;"/>
                Message</a>
              <a href="#!" class="evtBtnShare">
                <img src="../images/png/search.png" height="25px" width="20px" style="margin-top:7px;"/>
                Share</a>
            </div>

            <p>Here are some details that I am just putting here. Here are some details that I am just putting here. Here are some details that I am just putting here. Here are...<a class="modal-trigger" id="evtDetailTrigger" href="#moreDetails1">more info</a></p>

            <div class="evtSimpleInfo">
              <img src="../images/png/clock.png" height="30px" width="30px" style="position:relative;margin-top:5px;margin-left:20px;margin-right:20px;top:8px;"/>
              <h3 id="event_time">time</h3>
            </div>
            <div class="evtSimpleInfo">
              <img src="../images/png/person.png" height="30px" width="30px" style="position:relative;margin-top:10px;margin-left:20px;margin-right:20px;top:8px;"/>
              attendace</div>
            <div class="evtSimpleInfo">
              <img src="../images/png/location.png" height="30px" width="20px" style="position:relative;margin-top:10px;margin-left:25px;margin-right:25px;top:8px;"/>
              location</div>
            <div class="evtSimpleInfo">
              <img src="../images/png/homepage.png" height="30px" width="30px" style="position:relative;margin-top:10px;margin-left:20px;margin-right:20px;top:8px;"/>
              homepage</div>

            <!-- Modal Structure for details page -->
            <div id="moreDetails1" class="modal modal-fixed-footer">
              <div class="modal-content">
                <h4>Event Details</h4>
                <p>Add all event details</p>
              </div>
              <div class="modal-footer">
                <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat ">Close</a>
              </div>
            </div>

          </span>
        
        </li>
        <li class="scrollspy" id="evt1">
          <a href="#evt1" class="collapsible-header">test</a>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
        <li>
          <span id="target1" class="collapsible-header">test</span>
          <span id="target2" class="collapsible-body">test</span>
        </li>
        <li>
          <span class="collapsible-header">test</span>
          <span class="collapsible-body">test</span>
        </li>
 
      </ul>
    </aside>
    <!-- Map -->
    <section class="col s12 m12 l9" id="mapholder" style="height:100%; width:75%; margin-top:0.5%;"></section>
  </main>
</body>

</html>
